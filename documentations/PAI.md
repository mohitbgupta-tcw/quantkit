# Principal Adverse Impact Indicators

Principal Adverse Impacts (PAIs) encompass the most substantial adverse effects of investment decisions on sustainability factors, encompassing environmental, social, and employee considerations, human rights, as well as anti-corruption and anti-bribery aspects. Reporting on PAIs is obligatory on an annual basis for SFDR Article 8 and 9 funds, entailing 18 mandatory indicators and 2 optional indicators. Comprehensive details on these impacts must be provided annually in adherence to SFDR regulations. Reporting is required for the following factors.

| Principal Adverse Impact Indicators | Explanation |
:-------------------|:------------------|
| 1.1 - Scope 1 GHG Emissions | Sum of portfolio companies' Carbon Emissions - Scope 1 (tCO2e) weighted by the portfolio's value of investment in a company and by the company's most recently available enterprise value including cash, using MSCI Data |
| 1.2 - Scope 2 GHG Emissions | Sum of portfolio companies' Carbon Emissions - Scope 2 (tCO2e) weighted by the portfolio's value of investment in a company and by the company's most recently available enterprise value including cash, using MSCI Data |
| 1.3 - Scope 3 GHG Emissions | Sum of portfolio companies' Carbon Emissions - Scope 3 (tCO2e) weighted by the portfolio's value of investment in a company and by the company's most recently available enterprise value including cash, using MSCI Data |
| 1.4 - Total GHG Emissions (Scope 1,2,3) | Sum of portfolio companies' Total Carbon Emissions - Scope 1,2 and3 (tCO2e) weighted by the portfolio's value of investment in a company and by the company's most recently available enterprise value including cash, using MSCI Data |
| 2 - Carbon Footprint (Scope 1+2+3) | Sum of portfolio companies' Total Carbon Emissions - Scope 1,2 and3 (tCO2e) weighted by the portfolio's value of investment in a company and by the company's most recently available enterprise value including cash, normalized by 1 million eur invested in the portfolio, using MSCI Data |
| 3 - Weighted Average Carbon Intensity (Scope 1+2+3) | Portfolio weighted average of companies' Total GHG Emissions Intensity per EUR million Sales (t/EUR million sales), using MSCI Data |
| 4 - Fossil Fuel Exposure | Company’s exposure to fossil fuels related activities, including extraction, processing, storage and transportation of petroleum products, natural gas, and thermal and metallurgical coal, using MSCI Data |
| 5 - Non-Renewable Energy Consumption and Production | The company's energy consumption and/or production from non-renewable sources as a percentage of total energy use and/or generation, using MSCI Data |
| 6A - Energy Consumption Intensity by NACE (Agriculture, Foresty, Fishing) | Total Energy Consumption by NACE code, using MSCI data. Sectors refer to a Level 1 economic activity description identified by alphabetical letters A to U, based on the European Nomenclature of Economic Activities (NACE). |
| 6B - Energy Consumption Intensity by NACE (Mining and Quarrying) | Total Energy Consumption by NACE code, using MSCI data. Sectors refer to a Level 1 economic activity description identified by alphabetical letters A to U, based on the European Nomenclature of Economic Activities (NACE). |
| 6C - Energy Consumption Intensity by NACE (Manufacturing) | Total Energy Consumption by NACE code, using MSCI data. Sectors refer to a Level 1 economic activity description identified by alphabetical letters A to U, based on the European Nomenclature of Economic Activities (NACE). |
| 6D - Energy Consumption Intensity by NACE (Electricity, Gas Steam and Air Conditioning Supply) | Total Energy Consumption by NACE code, using MSCI data. Sectors refer to a Level 1 economic activity description identified by alphabetical letters A to U, based on the European Nomenclature of Economic Activities (NACE). |
| 6E - Energy Consumption Intensity by NACE (Manufacturing) | Total Energy Consumption by NACE code, using MSCI data. Sectors refer to a Level 1 economic activity description identified by alphabetical letters A to U, based on the European Nomenclature of Economic Activities (NACE). |
| 6F - Energy Consumption Intensity by NACE (Contruction) | Total Energy Consumption by NACE code, using MSCI data. Sectors refer to a Level 1 economic activity description identified by alphabetical letters A to U, based on the European Nomenclature of Economic Activities (NACE). |
| 6G - Energy Consumption Intensity by NACE (Wholesale and Retail Trade) | Total Energy Consumption by NACE code, using MSCI data. Sectors refer to a Level 1 economic activity description identified by alphabetical letters A to U, based on the European Nomenclature of Economic Activities (NACE). |
| 6H - Energy Consumption Intensity by NACE (Water Transport) | Total Energy Consumption by NACE code, using MSCI data. Sectors refer to a Level 1 economic activity description identified by alphabetical letters A to U, based on the European Nomenclature of Economic Activities (NACE). |
| 6L - Energy Consumption Intensity by NACE (Real Estate Activities) | Total Energy Consumption by NACE code, using MSCI data. Sectors refer to a Level 1 economic activity description identified by alphabetical letters A to U, based on the European Nomenclature of Economic Activities (NACE). |
| 7 - Activities Neg Affecting Biodiversity                                                      | % of company reports having operations in or near to biodiversity sensitive areas and has been implicated in controversies with severe or very severe adverse impact on the environment, using MSCI data. |
| 8 - Emissions to Water | Weighted average direct emissions (in metric tons) of priority substances and pollutants which were discharged into bodies of water as a result of company operations, using MSCI data. normalized by million eur invested. |
| 9 - Hazardous Waste Ratio | Weighted % of total hazardous waste (metric tons), using MSCI data. normalized by million eur invested. |
| 10 - Violations of UNGC and OECD | % of companies by market value with a severe overall company assessment, signaling whether a company has a notable controversy related to its operations and/or products, and the severity of the social or environmental impact of the controversy, using MSCI data. |
| 11 - Lack of Processes to Monitor of UNGC and OECD | % of portfolio with companies that haave a poor due diligence policy on labor issues addressed by the fundamental International Labor Organisation (ILO) Conventions 1 to 8 or companies that are not signatories to the UN Global Compact, using MSCI data |
| 12 - Unadjusted Gender Pay Gap | Portfolio weighted average of the difference between the average gross hourly earnings of male and female employees as a percentage of male gross earnings, using MSCI data. |
| 13 - Board Gender Diversity | The percentage of board members who are female, using MSCI data. For companies with a two-tier board, the calculation is based on members of the Supervisory Board only. |
| 14 - Exposure to Controversial Weapons | % of companies that have a tie to landmines, cluster munitions, chemical weapons or biological weapons, using MSCI data. Note: Industry tie includes ownership, manufacture or investment. Landmines do not include related safety products. |
| 15 - GHG Intensity of Investee Countries | Tons of CO2e emissions per EUR million GDP of the country, using MSCI Data.   National territorial emissions are sourced from EDGAR. Nominal GDP level is sourced from WDI. Currency conversion of Nominal GDP to euros uses the average annual nominal exchange rate level. |
| 16 - Investee Countries Subject to Social Violations | % of portfolio in countries with European External Action Service (EEAS) trade sanctions – trade sanctions may be limited to certain materials, e.g., arms, diamonds, etc |
| 17 - Exposure to fossil fuels through real estate assets | - |
| 18 - Exposure to energy-inefficient real estate assets | - |
| Additional Environmental - Investment in Companies w/o Carbon Emissions Reduction Targets | % of portfolio companies without a carbon-emissions reduction target |
| Additional Social - No Workplace Accident Prevention Policy | % of portfolio companies without s a health & safety/workplace accident prevention policy that applies to all direct operations (groupwide) the group (i.e.,  includes subsidiaries, etc.). 

## Usage
---
QuantKit users have the flexibility to employ and execute the package in two distinct ways. For additional details, refer to this [demo notebook](https://ml.azure.com/fileexplorerAzNB?wsid=/subscriptions/9e6414f9-fa32-459d-87f7-26856c9ebc31/resourceGroups/rg-sub-ae-shared-dev-001-esgmlws/providers/Microsoft.MachineLearningServices/workspaces/mlw-sub-ae-shared-dev-001-esgmlws&tid=b730b432-2098-413f-bd4a-014acdf7c72e&activeFilePath=Users/Tim.Bastian/quantkit/PAI.ipynb).

### Configs-File Set-Up
Before executing the PAI functionality, ensure proper configuration of your local configs file. Specify the following parameters:

- API-Settings: Set Snowflake parameters

```shell

    "API_settings": {
        "snowflake_parameters": {
            "user": "user_name",
            "password": "password"
        }
    }

```

- As Of Date: Specifies the date on which the framework should be executed.

```shell

    "as_of_date": "01/31/2023"

```

- Exchange Rate: Indicates the current exchange rate for EUR/USD as of the specified date.

```shell

    "exchange_rate": 0.9802

```

- MSCI Parameters: Define the month for which MSCI data should be retrieved. `start_date` should be set to the start of the month, while `end_date` and `as_at_date` should be set to the start of the subsequent month.

```shell

    "msci_datasource": {
        "filters": {
            "start_date": "2022-09-01",
            "end_date": "2022-10-01",
            "as_at_date": "2022-10-01"
        }
    }

```

- Portfolios, optional: For Portfolios, specify the portfolios on which the PAI framework should be executed on. Defaults to "701", "702", "703", "704", "705", "706", "707", "708", "709", "710", "711", "712", "713", "714", "3237", "3704", "3720", "3730", "3735", "3738", "3750", "3775", "3798", "4790", "6283", "6293", "6717", "6739", "6741", "6748", "6751", "6757", "6781", "6784", "13727", "13751", "16703", "16705", "16706", "16719", "16720", "3666", "3667", "3668", "3669", "6293", "3778", "3234", "3660", "3659". If the user wishes to run it on all available TCW portfolios, enter ["all"], and if the user wants to exclude all available TCW portfolios, enter an empty list [].

```shell

    "tcw_universe": ["all"],

```

- Equity Benchmark, optional: The user designates the equity benchmark indices on which the framework should be executed. Defaults to "JESG EMBI Global Diversified Index", "JPM CEMBI BROAD DIVERSE", "JPM EMBI GLOBAL DIVERSIFI", "MSCI WORLD", "Russell 1000", "RUSSELL 1000 GROWTH", "RUSSELL 1000 VALUE", "RUSSELL 3000 GROWTH INDEX", "RUSSELL 3000 INDEX", "S & P 500 INDEX", "MSCI EAFE", "RUSSELL 2000", "RUSSELL 2000 VALUE", "RUSSELL MIDCAP", "Russell Midcap Value", "S&P 500 EX TOBACCO". If the user wants to exclude all available benchmark portfolios, enter [].

```shell

    "equity_universe": [],

```

- Fixed Income Benchmark, optional: The user designates the fixed income benchmark indices on which the framework should be executed. Defaults to "BB HIGH YIELD 2% CAP", "BB INTERMEDIATE CORP", "BLOOMBER LONG GOVT/CREDIT", "BLOOMBERG AGGREGATE INDEX", "Pan Euro Credit", "Pan Euro High Yield". If the user wants to exclude all available benchmark portfolios, enter [].

```shell

    "fixed_income_universe": [],

```

### The Object Method
Proficient users can leverage the structure of objects generated within the code. Begin by initializing a runner object using the following method.

```python

import quantkit.runners.runner_PAI as runner

local_configs = "path\\to\\your\\configs.json"

r = runner.Runner()
r.init(local_configs=local_configs)
r.run()

```

This establishes connections to all databases and executes the calculations. To retrieve datapoints, we can inspect the objects. We access a portfolio object in the following way.

```python

r.portfolio_datasource.portfolios["3750"].impact_data

```

### The handyman Folder

The `handyman` folder serves as a user-friendly option for those solely interested in the output rather than the objects. It offers functions to execute the PAI framework and obtain pertinent data without navigating through the objects. To run the PAI framework and obtain a detailed DataFrame, execute the `principal_adverse_impact()` function available in the `pai` package.

```python

import quantkit.handyman.pai as pai

local_configs = "path\\to\\your\\configs.json"

df = pai.principal_adverse_impact(local_configs)

```

To obtain the original data points for each security of each portfolio utilized in the calculation, execute the following function.

```python

import quantkit.handyman.pai as pai

local_configs = "path\\to\\your\\configs.json"

df = pai.principal_adverse_data_points(local_configs)

```